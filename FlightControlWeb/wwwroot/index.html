<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <title></title>
    <!-- Add icon delete library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <style>

        * {
            box-sizing: border-box;
        }

        /* Create two equal columns that floats next to each other */
        .column {
            float: left;
            height: 60%;
            width: 50%;
            padding: 10px;
        }

        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        /* Create smaller columns that floats next to each other */
        .columnt1 {
            float: left;
            width: 25%;
            padding: 10px;
        }

        /* Create tables */
        table {
            width: 100%;
        }

        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
        }

        table#t01 tr:nth-child() {
            background-color: #eee;
        }

        table#t01 th {
            background-color: #87CEFA;
            color: black;
        }

        .btn {
            background-color: DodgerBlue;
            border: none;
            color: white;
            padding: 12px 16px;
            font-size: 16px;
            cursor: pointer;
        }

        /* Darker background on mouse-over */
        .btn:hover {
            background-color: RoyalBlue;
        }

        /* Create map */
        #map {
            width: 50%;
            height: 50%;
            zoom: 1;
            position: absolute;
            top: 10px;
            bottom: 0;
            left: 0;
            right: 0
        }
    </style>
</head>
<body>

    <div class="row">
        <div class="column" style="background-color:#4cff00;">
            <div id="map"></div>
        </div>
        <div class="column" style="background-color:#bbb;">

            <h2>My Flights</h2>
            <table id="t01">
                <tr>
                    <th>Flight Id</th>
                    <th>Company Name</th>
                    <th>Delete</th>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <!--
    <td>Jill</td>
    <td>Smith</td>
        -->
                    <td>
                        <button type="button" class="btn" onclick="deleteRow(this)">
                            <span class="fa fa-close"></span>
                            <span class="submit-text"> Delete</span>
                        </button>
                    </td>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <!--
    <td>Eve</td>
    <td>Jackson</td>
        -->
                    <td>
                        <button type="button" class="btn" onclick="deleteRow(this)">
                            <span class="fa fa-close"></span>
                            <span class="submit-text"> Delete</span>
                        </button>
                    </td>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <!--
    <td>John</td>
    <td>Doe</td>
        -->
                    <td>
                        <button type="button" class="btn" onclick="deleteRow(this)">
                            <span class="fa fa-close"></span>
                            <span class="submit-text"> Delete</span>
                        </button>
                    </td>
                </tr>
            </table>

            <h2>External Flights</h2>
            <table id="t02" scrolling="yes">
                <tr>
                    <th>Flight Id</th>
                    <th>Company Name</th>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <td>Jill</td>
                    <td>Smith</td>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <td>Eve</td>
                    <td>Jackson</td>
                </tr>
                <tr onClick="HighLightTR(this,'#d25dbb');">
                    <td>John</td>
                    <td>Doe</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="FlightDetails">
            <div class="columnt1">
                <h3>Flight Details</h3>
                <div class="row">
                    <i class='fas fa-plane'></i>
                    Flight Id:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    Company Name:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    Number Of Passengers:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    External Flight:
                </div>
            </div>
            <div class="columnt1">
                <br /> <br /> <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    Initial Location:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    End Location:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    Initial Date Time:
                </div>
                <br />
                <div class="row">
                    <i class='fas fa-plane'></i>
                    End Date Time:
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <form class="my-form" method="post" action="/">
            <h3>upload file</h3>
            <label class="button" for="fileItem">select files</label>
            <input type="file" id="fileItem" accept="/application/json">
            <!-- TODO: IMPLEMENT READ -->
                    <input type="button" id="submition" value="submit" onclick="readFiles()" />
                    </form>
</div>
    <script>
        let map = L.map('map').setView([0, 0], 1);

        L.tileLayer('https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=JZeDrYmO2BGmKe83fmkO', {
            attribiution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
        }).addTo(map);

        // Create airplane icon.
        let airplaneIcon = L.Icon.extend({
            options: {
                // size of the icon
                iconSize: [25, 40],
                // point from which the popup should open relative to the iconAnchor
                popupAnchor: [-3, -76]
            }
        });
        let airplane1 = new airplaneIcon({ iconUrl: 'airplane.png' }),
            airplane2 = new airplaneIcon({ iconUrl: 'purpleAirplane.png' });

        let layer = L.marker([51.5, -0.09], { icon: airplane1 });
        let layer1 = L.marker([51.5, -0.09], { icon: airplane2 });
        layer.addTo(map);

        // After clicking on the airplane, change it's color.
        layer.on('click', function (ev) {
            layer.remove();
            // The same position, color change.
            layer1.addTo(map);
        });

        // After clicking on the map, change the airplane color back.
        map.on('click', function (e) {
            layer1.remove();
            layer.addTo(map);
        });
    </script>

    <script>
        // Delete flight button
        function deleteRow(r) {
            var i = r.parentNode.parentNode.rowIndex;
            document.getElementById("t01").deleteRow(i);
        }

        // Highlight row after clicking it
        var preEl;
        var orgBColor;
        var orgTColor;
        function HighLightTR(el, backColor) {
            if (typeof (preEl) != 'undefined') {
                preEl.bgColor = orgBColor;
            }
            orgBColor = el.bgColor;
            orgTColor = el.style.color;
            el.bgColor = backColor;
            preEl = el;
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--<script>
        $(document).ready(function () {
            getFlights();
        });

        function getFlights() {
            let d = new Date(Date().toString('en-US', { timeZone: "Etc/GMT-0" }));            let url = "/api/Flights?relative_to=" + d.toISOString();
            
            $.ajax({
                type: "GET",
                url: url,
                datatype: 'json',
                success: successGetFlights,
                error: function () {
                    alert("Error getFlights");
                }
            });
        }
        function successGetFlights(flights) {
            flights.forEach(function (flight, i) {
                let id = flight.flight_Id;
                if (!flight.is_external) {
                    $('#t01').append('<tr><td>' + id + '</td><td>' + flight.company_Name + '</td></tr>');
                }
            });
        }
    </script>-->
</body>
</html>